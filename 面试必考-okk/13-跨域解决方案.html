<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      //1、通过JSONP跨域 只能实现get一种请求
      var script = document.createElement("script");
      script.type = "text/javascript";
      //传参一个回调函数给后端，方便后端返回时执行这个在前端定义的回调函数
      script.src =
        "http://www.domain2.com:8080/login?user=admin&callback=handleCallback";
      document.head.appendChild(script);
      function handleCallback(res) {
        alert(JSON.stringify(res));
      }
      //2、document.domain+iframe跨域
      //仅限主域相同 子域不同的跨域应用场景
      //两个页面都通过js强制设置document.domain为基础主域，就实现了同域。
      //父窗口:(http://www.domain.com/a.html)
      <iframe id="iframe" src="http://child.domain.com/b.html"></iframe>;
      document.domain = "domain.com";
      var user = "admin";
      //子窗口:(http://child.domain.com/b.html)
      document.domain = "domain.com";
      alert("get js data from parent--" + window.parent.user);
      //3、跨域资源共享
      //普通跨域请求：只要服务端设置Access-Control-Allow-Origin即可，前端无需设置；若要带cookie请求，前后端都要设置
      //前端设置
      xhr.withCredentials = true;
      //后端设置

      // 导入包：import javax.servlet.http.HttpServletResponse;
      // 接口参数中定义：HttpServletResponse response

      // 允许跨域访问的域名：若有端口需写全（协议+域名+端口），若没有端口末尾不用加'/'
      response.setHeader(
        "Access-Control-Allow-Origin",
        "http://www.domain1.com"
      );

      // 允许前端带认证cookie：启用此项后，上面的域名不能为'*'，必须指定具体的域名，否则浏览器会提示
      response.setHeader("Access-Control-Allow-Credentials", "true");

      // 提示OPTIONS预检时，后端需要设置的两个常用自定义头
      response.setHeader(
        "Access-Control-Allow-Headers",
        "Content-Type,X-Requested-With"
      );
      //4、服务器代理，当有跨域的请求操作时发送给后端，让后端帮你代为请求
    </script>
  </body>
</html>
